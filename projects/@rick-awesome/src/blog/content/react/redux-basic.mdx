---
title: React Quick Start - Redux Basics
---

æœ¬æ–‡å‚è€ƒå¦‚ä¸‹æ–‡æ¡£

> <a href="https://redux.js.org/">Redux å®˜æ–¹æ–‡æ¡£</a>

> <a href="https://www.redux.org.cn/">Redux ä¸­æ–‡æ–‡æ¡£</a>

## Redux ç®€ä»‹

<img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/7445498d73ca4f749894fba79f3ac6d3~tplv-k3u1fbpfcp-zoom-1.image" />

Redux ç”± Flux æ¼”å˜è€Œæ¥ æ˜¯ä¸€å¥—ç®¡ç†å…¬å…±çŠ¶æ€çš„ç¬¬ä¸‰æ–¹å·¥å…·

> å…³äº Flux æ€æƒ³ å¯å‚è€ƒ <a href="http://www.ruanyifeng.com/blog/2016/01/flux.html">é˜®ä¸€å³°çš„ç½‘ç»œæ—¥å¿—</a>

è™½ç„¶ä¸æ˜¯ React å®˜æ–¹å¼€å‘ ä½†å·²ç»æˆä¸º React ç®¡ç†çŠ¶æ€äº‹å®ä¸Šçš„æ ‡å‡†

### Redux å·¥ä½œæµç¨‹

<img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/3d762c4fc4ff4fa3bcc50885566d62a9~tplv-k3u1fbpfcp-zoom-1.image" />

- View è§†å›¾å±‚å†…æ´¾å‘ action `(dispatch(action))`

- Reducer æ¥æ”¶åˆ° action è¿›è¡Œåˆ†å‘å’Œå¤„ç† è¿”å›ä¸€ä¸ªæ–°çš„ state ç»™ store

- Store æ¥æ”¶åˆ°æ–°çš„ state æ•°æ®å‘ç”Ÿæ”¹å˜

- View è§†å›¾å±‚ é€šè¿‡ store.subscribe è®¢é˜… store æ›´æ–°é¡µé¢

å…·ä½“æµç¨‹å¯è§ä¸‹å›¾

<img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/35aaef12c7694057a0c2c5a67f0dbfa5~tplv-k3u1fbpfcp-zoom-1.image" />

<img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/053ae7c3512a413e90ddd13a4d5ac3fb~tplv-k3u1fbpfcp-zoom-1.image" />

### ä¸‰å¤§åŸåˆ™

#### å•ä¸€æ•°æ®æº

è™½ç„¶ Redux æºäº Flux æ¶æ„ ä½†æ˜¯å®ƒå¹¶ä¸æ˜¯å®Œå…¨æŒ‰ç…§ Flux æ¶æ„å»è®¾è®¡çš„

ä¾‹å¦‚ Flux æ¶æ„ä¸­ å…è®¸æœ‰å¤šä¸ª store ä½†æ˜¯ Redux ä¸­åªå…è®¸æœ‰ä¸€ä¸ª store å­˜åœ¨

æ‰€æœ‰çš„ state éƒ½è¢«å­˜åœ¨äº†å”¯ä¸€çš„ä¸€ä¸ª store ä¸­

è¿™ä¹Ÿå°±ç¡®ä¿äº†æ•°æ®çš„`å¯è¿½è¸ª`å’Œ`å¯é¢„æµ‹`

#### ä¸å¯å˜æ•°æ®

ä¸è¦å°è¯•ç›´æ¥ä¿®æ”¹ store ä¸­çš„æ•°æ® è¿™å°†ä¼šä½¿ä½ çš„åº”ç”¨å‘ç”Ÿä¸å¯é¢„æµ‹çš„ç»“æœ

å”¯ä¸€æ”¹å˜ state çš„æ–¹æ³•å°±æ˜¯è§¦å‘ action

è¿™æ · æ¯æ¬¡ä½ çš„ä¿®æ”¹éƒ½ä¼šè¿”å›ä¸€ä¸ªæ–°çš„ store

Redux å°±å¯ä»¥è®°å½•æ¯ä¸€æ¬¡ store çš„å˜åŒ– ä»è€Œå®ç°è°ƒè¯•ç­‰åŠŸèƒ½

#### ä½¿ç”¨çº¯å‡½æ•°

> æ­¤å‡½æ•°åœ¨ç›¸åŒçš„è¾“å…¥å€¼æ—¶ï¼Œéœ€äº§ç”Ÿç›¸åŒçš„è¾“å‡ºã€‚å‡½æ•°çš„è¾“å‡ºå’Œè¾“å…¥å€¼ä»¥å¤–çš„å…¶ä»–éšè—ä¿¡æ¯æˆ–çŠ¶æ€æ— å…³ï¼Œä¹Ÿå’Œç”± I/O è®¾å¤‡äº§ç”Ÿçš„å¤–éƒ¨è¾“å‡ºæ— å…³ã€‚
> è¯¥å‡½æ•°ä¸èƒ½æœ‰è¯­ä¹‰ä¸Šå¯è§‚å¯Ÿçš„å‡½æ•°å‰¯ä½œç”¨ï¼Œè¯¸å¦‚â€œè§¦å‘äº‹ä»¶â€ï¼Œä½¿è¾“å‡ºè®¾å¤‡è¾“å‡ºï¼Œæˆ–æ›´æ”¹è¾“å‡ºå€¼ä»¥å¤–ç‰©ä»¶çš„å†…å®¹ç­‰ã€‚ ------ ç»´åŸºç™¾ç§‘

Reducer åªæ˜¯ä¸€äº›çº¯å‡½æ•° è¿™æ„å‘³ç€ Reducer çš„ç»“æœå°†åªå— Action æ§åˆ¶

å†å›è¿‡å¤´æ¥çœ‹ Redux çš„å®˜æ–¹å®šä¹‰

> A Predictable State Container for JS Apps ----- Redux å®˜æ–¹

æˆ‘ä»¬ä¼šå‘ç° è¿™ä¸‰å¤§åŸåˆ™å…¶å®éƒ½åªåœ¨ä¸€ä»¶äº‹ å°±æ˜¯ Predictable å¯é¢„æµ‹çš„

## Store: å®ƒæ˜¯ä¸€ä¸ªå•ä¸€çš„æ•°æ®æºï¼Œè€Œä¸”æ˜¯åªè¯»çš„

<img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/9c9c5b41a2b847c2972d5a3b678912bd~tplv-k3u1fbpfcp-zoom-1.image" />

## Action: æ˜¯â€œåŠ¨ä½œâ€çš„æ„æ€ï¼Œå®ƒæ˜¯å¯¹å˜åŒ–çš„æè¿°

<img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/4eb5bd6d834f4f64869f8313b7c43890~tplv-k3u1fbpfcp-zoom-1.image" />

## Reducer: å®ƒè´Ÿè´£å¯¹å˜åŒ–è¿›è¡Œåˆ†å‘å’Œå¤„ç†ï¼Œæœ€ç»ˆå°†æ–°çš„æ•°æ®è¿”å›ç»™ Store

<img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/6b400f11cea6485288f3a5dcca1c1d18~tplv-k3u1fbpfcp-zoom-1.image" />

## API

### creatorStore

åˆ›å»º store å¯¹è±¡

### appleMiddleware

ä½¿ç”¨ä¸­é—´ä»¶ åœ¨ä¸‹ä¸€è®²ä¸­é—´ä»¶ä¸­ä¼šæåˆ°

### bindActionCreators

è¯¥ Api ç”¨äºå°† action å’Œ dispatch ç»‘å®š ä»è€Œä½¿ç»„ä»¶å¯ä»¥æ— æ„ŸçŸ¥ Redux çš„å­˜åœ¨

```js
const { dispatch } = useDispatch();
const _bindActionCreators = bindActionCreators(
  {
    // å®šä¹‰å¥½çš„ä¸€äº›actionCreators
    addCounter,
    subCounter,
  },
  dispatch,
);

// è¿™æ ·å°±å¯ä»¥æ´¾å‘ä¸€ä¸ªactionäº†
_bindActionCreators.addCounter();
```

### combineReducers

å½“æˆ‘ä»¬çš„é¡µé¢å˜å¾—è¶Šæ¥è¶Šå¤æ‚çš„æ—¶å€™ å¯èƒ½æˆ‘ä»¬éœ€è¦é’ˆå¯¹æ¨¡å—æ‹†åˆ†ä¸åŒçš„ Store

è¿™ä¸ª Api å°±å¯ä»¥å¸®æˆ‘ä»¬é‡æ–°ç»„åˆè¿™äº› Store å˜æˆä¸€ä¸ª Store

<img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/56c63afe59dd44798b3f1f8f61eafacc~tplv-k3u1fbpfcp-zoom-1.image" />

### connect

ç”¨äºå°† Store å’Œ Action æ˜ å°„åˆ°ç»„ä»¶çš„ props ä¸Š

<img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/9aead73d371b4df6ae18e9028dc0c624~tplv-k3u1fbpfcp-zoom-1.image" />

### compose

compose æ˜¯å‡½æ•°å¼ç¼–ç¨‹ä¸­çš„æ–¹æ³• ç”¨æ¥ä»å³åˆ°å·¦æ¥ç»„åˆå¤šä¸ªå‡½æ•°

æœ¬æ–‡åªåš Redux çš„å…¥é—¨ æ‰€ä»¥ compose è¿™ä¸ªå‡½æ•°å¯ä»¥åœ¨å‡½æ•°å¼ç¼–ç¨‹ä¸­æ·±ç©¶

## Redux DevTools

è¿™æ˜¯ä¸€ä¸ª Chrome çš„æ’ä»¶ å¯ä»¥è®©æˆ‘ä»¬æ›´å¥½çš„è°ƒè¯•æˆ‘ä»¬çš„ Redux

<img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/11f100b78b3441c8adbf311582af1290~tplv-k3u1fbpfcp-zoom-1.image" />

## react-redux

è¿™æ˜¯ä¸€ä¸ªç”¨äºå°†ä½ çš„ç»„ä»¶å’Œ Redux æ›´æ–¹ä¾¿è¿æ¥çš„ç»„ä»¶åº“

ä½¿ç”¨ å¦‚ä¸‹

```tsx
import { Provider, useDispatch, useSelector } from 'react-redux';

<Provider store={store}>
  <A />
  <B />
  <C />
</Provider>;
```

å¦‚æ­¤ä¸€æ¥ A B C ç»„ä»¶ä¾¿éƒ½æœ‰èƒ½åŠ›è·å–åˆ° Store ä¸­çš„æ•°æ®äº†

å…·ä½“çš„ç”¨æ³• å¯ä»¥çœ‹æ¥ä¸‹æ¥çš„ Demo

## ğŸŒ°

è¿™é‡Œæˆ‘ç”¨ä¸€ä¸ªè®¡æ•°å™¨çš„ ğŸŒ° æ¥å¿«é€Ÿè¿‡ä¸€é Redux

é¦–å…ˆ åˆ›å»ºæˆ‘ä»¬çš„ store

```ts
// å¯¼å…¥æ ¸å¿ƒAPI åˆ›å»ºStore
import { createStore } from 'redux';

export interface IStore {
  count: number;
}

export interface IAction {
  type: string;
  [key: string]: any;
}

// å®šä¹‰æˆ‘ä»¬çš„ Action Type
enum ACTION_TYPE {
  ADD_COUNTER = 'ADD_COUNTER',
  SUB_COUNTER = 'SUB_COUNTER',
}

// å¯¹å¤–æš´éœ² Action Creators ç”¨äºç»„ä»¶è°ƒç”¨
export const addCounter = (payload: number) => ({
  type: ACTION_TYPE.ADD_COUNTER,
  payload,
});

export const subCounter = (payload: number) => ({
  type: ACTION_TYPE.SUB_COUNTER,
  payload,
});

// åˆ›å»ºä¸€ä¸ªåˆå§‹åŒ–çš„Store
const initStore: IStore = {
  count: 0,
};

// åˆ›å»ºReducer ç”¨äºç®¡ç† View æ´¾å‘è¿‡æ¥çš„ Action
const reducer = (store = initStore, action: IAction) => {
  switch (action.type) {
    case ACTION_TYPE.ADD_COUNTER:
      return { ...store, count: store.count + action.payload };
    case ACTION_TYPE.SUB_COUNTER:
      return { ...store, count: store.count - action.payload };
    default:
      return store;
  }
};

// åˆ›å»º Store è¿™é‡Œæˆ‘ä»¬è¿˜å¼€å¯äº† Redux DEVTools
export const store = createStore(
  reducer,
  (window as any).__REDUX_DEVTOOLS_EXTENSION_COMPOSE__(),
);
```

è§†å›¾å±‚çš„ä»£ç å¦‚ä¸‹

```tsx
import { useState } from 'react';
import { Button, Input } from 'antd';
import { Provider, useDispatch, useSelector } from 'react-redux';
import { store, addCounter, subCounter, IStore } from './store';

function Counter() {
  // è·å– Store ä¸­çš„æ•°æ®
  const { count } = useSelector((store: IStore) => store);
  const dispatch = useDispatch();
  const [payload, setPayload] = useState<number>(1);

  return (
    <>
      <Input
        value={payload}
        onChange={v => setPayload(parseInt(v.target.value))}
      />
      <Button onClick={() => dispatch(addCounter(payload))}>+</Button>
      <Button>{count}</Button>
      <Button onClick={() => dispatch(subCounter(payload))}>-</Button>
    </>
  );
}

export default function Root() {
  return (
    <Provider store={store}>
      <Counter />
    </Provider>
  );
}
```

<Codesandbox id="redux-basic-usage-c62hr9" />

## æ€è€ƒ

æœ¬æ–‡ä¸­çš„ reducers éƒ½æ˜¯åŒæ­¥ä»£ç  å¦‚æœæˆ‘ä»¬åœ¨å‘é€ action çš„æ—¶å€™ éœ€è¦æ‰§è¡Œä¸€äº›å¼‚æ­¥æ“ä½œ è¿™ä¸ªæ—¶å€™åº”è¯¥æ€ä¹ˆåŠå‘¢

reducer ä¸­æ˜¯å¦å¯ä»¥å¤„ç†å¼‚æ­¥æ“ä½œå‘¢ ï¼Ÿï¼Ÿï¼Ÿ
