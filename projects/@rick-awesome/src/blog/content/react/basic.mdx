---
title: React Quick Start - Basic Syntax
---

> æ³¨ï¼šæœ¬ç« èŠ‚çš„ demo éƒ½ä»¥`ç±»ç»„ä»¶ + TS`ä¸ºä¾‹ ç­‰ä¸‹ä¸€ç«  hook ç« èŠ‚åéƒ½ä¸ºå‡½æ•°å¼ç»„ä»¶

> æ³¨ï¼šåœ¨å†™æœ¬ç« èŠ‚çš„æ—¶å€™ React å·²ç»æ›´æ–°åˆ° 17 ç‰ˆæœ¬ ä¸å¿…åœ¨ä»£ç ä¸­æ‰‹åŠ¨å¯¼å…¥ React äº†

> UI åº“ ç»Ÿä¸€ä½¿ç”¨ `antd` https://ant.design/components/overview-cn/

## åˆå§‹åŒ–é¡¹ç›®

ä½¿ç”¨ webpack

```sh
npx create-react-app my-app --template typescript

# or

yarn create react-app my-app --template typescript
```

ä½¿ç”¨ vite

```sh
npm init vite@latest my-vue-app -- --template react-ts

# or

yarn create vite my-vue-app --template react-ts
```

å¦‚æœä½ æš‚æ—¶è¿˜ä¸éœ€è¦é›†æˆ typescript çš„è¯ å¯ä»¥å»æ‰ --template typescript

## çˆ¶å­ç»„ä»¶é€šä¿¡

### çˆ¶ç»„ä»¶ --> å­ç»„ä»¶

çˆ¶ --> å­ æ¯”è¾ƒç®€å•

çˆ¶ç»„ä»¶ç›´æ¥é€šè¿‡ props æ¥ä¼ é€’å±æ€§

ç±»ç»„ä»¶ç”¨`this.props.[å±æ€§å]`å³å¯æ‹¿åˆ°å¯¹åº”çš„å±æ€§

å‡½æ•°å¼ç»„ä»¶ç›´æ¥ä½¿ç”¨`props.[å±æ€§å]`å³å¯

### å­ç»„ä»¶ --> çˆ¶ç»„ä»¶

åŸç†å’Œ çˆ¶ --> å­ ç±»ä¼¼

åœ¨çˆ¶ç»„ä»¶ç”¨ props å‘å­ç»„ä»¶ä¼ é€’ä¸€ä¸ªå‡½æ•°

ç„¶ååœ¨å­ç»„ä»¶ç”¨`this.props.<å‡½æ•°å>`è§¦å‘è¿™ä¸ªå‡½æ•°

ä»¥ä¸‹æ˜¯ä¸€ä¸ªè®¡æ•°å™¨ç´¯åŠ çš„ ğŸŒ°

çˆ¶ç»„ä»¶è´Ÿè´£ç®¡ç†æ•°æ®å’Œæ–¹æ³•

ä¸‹é¢æ˜¯ç»„ä»¶é—´çš„é€šä¿¡

çˆ¶ç»„ä»¶å‘å­ç»„ä»¶ä¼ é€’ count å˜é‡

å­ç»„ä»¶è§¦å‘çˆ¶ç»„ä»¶ ç´¯åŠ æ–¹æ³•

```tsx
import { Component } from 'react';
import { Button } from 'antd';

interface IProps {
  count?: number;
  onClick?: () => void;
}

interface IState {
  count: number;
}

class ChildComponent extends Component<IProps, IState> {
  render() {
    const { count, onClick } = this.props;
    return <Button onClick={onClick}>{count}</Button>;
  }
}

class ParentComponent extends Component<IProps, IState> {
  constructor(props: IProps) {
    super(props);
    this.state = {
      count: 0,
    };
  }
  handleClick() {
    this.setState({
      count: this.state.count + 1,
    });
  }
  render() {
    return (
      <ChildComponent count={this.state.count} onClick={this.handleClick} />
    );
  }
}

export default ParentComponent;
```

å¦‚æœä½ æ‰§è¡Œä¸Šè¿°ä»£ç çš„è¯ ä½ ä¼šå‘ç°æ•°æ®å¯ä»¥æ­£å¸¸æ˜¾ç¤º è¿™è¯´æ˜çˆ¶ç»„ä»¶çš„æ•°æ®æ­£ç¡®çš„ä¼ é€’ç»™äº†å­ç»„ä»¶

ä½†æ˜¯ä¸€æ—¦ç‚¹å‡»äº†æŒ‰é’® é¡µé¢å°±ä¼šæŠ¥é”™ ä½ ä¼šçœ‹åˆ°å¦‚ä¸‹æŠ¥é”™ä¿¡æ¯

> TypeError: Cannot read property 'setState' of undefined

ä¹Ÿå°±æ˜¯ this æ˜¯ undefined

åœ¨ä¸Šä¸€è®²æˆ‘ä»¬å°±è¯´åˆ° åœ¨ç±»ç»„ä»¶ä¸­ç»‘å®šäº‹ä»¶æ—¶è¦æ³¨æ„ this çš„ç»‘å®š

React å¹¶æ²¡æœ‰å¸®æˆ‘ä»¬ç»‘å®š this å¦‚æœæˆ‘ä»¬æ²¡æœ‰æ‰‹åŠ¨ç»‘å®š é‚£ä¹ˆå®ƒå°±æ˜¯ undefined

å…³äº React ä¸ºä»€ä¹ˆæ²¡æœ‰å¸®æˆ‘ä»¬ç»‘å®š this ä½ å¯ä»¥æˆ³ ğŸ‘‰<a href="https://www.zhihu.com/question/300850914">è¿™ç¯‡æ–‡ç« </a>

è§£å†³çš„æ–¹æ³•æœ‰ä¸¤ç§

1. æ‰‹åŠ¨ç»‘å®š this åœ¨çˆ¶ç»„ä»¶çš„æ„é€ å‡½æ•°å¤„ æ‰‹åŠ¨ç»‘å®šä¸ºæ–¹æ³• ç»‘å®š this

```tsx
constructor(props: IProps) {
  super(props);
  this.state = {
    count: 0,
  };
  this.handleClick = this.handleClick.bind(this);
}
```

2. ä½¿ç”¨ç®­å¤´å‡½æ•°

```tsx
<ChildComponent count={this.state.count} onClick={() => this.handleClick()} />
```

<Codesandbox id="fu-zi-zu-jian-tong-xin-dwzcv3" />

è¿™é‡Œå†è¡¥å……ä¸€ä¸ªå•é¡¹æ•°æ®æµçš„æ¦‚å¿µ

æ‰€è°“å•å‘æ•°æ®æµï¼ŒæŒ‡çš„å°±æ˜¯å½“å‰ç»„ä»¶çš„ state ä»¥ props çš„å½¢å¼æµåŠ¨æ—¶ï¼Œ**åªèƒ½æµå‘ç»„ä»¶æ ‘ä¸­æ¯”è‡ªå·±å±‚çº§æ›´ä½çš„ç»„ä»¶ã€‚** Â  æ¯”å¦‚åœ¨çˆ¶-å­ç»„ä»¶è¿™ç§åµŒå¥—å…³ç³»ä¸­ï¼Œåªèƒ½ç”±çˆ¶ç»„ä»¶ä¼  props ç»™å­ç»„ä»¶ï¼Œè€Œä¸èƒ½åè¿‡æ¥ã€‚

æ‰€ä»¥å­ç»„ä»¶åªèƒ½é€šè¿‡è°ƒç”¨çˆ¶ç»„ä»¶çš„å‡½æ•° ç”¨å‡½æ•°ä¼ å‚çš„å½¢å¼å°†æ•°æ®ä¼ é€’ç»™çˆ¶ç»„ä»¶

## ç”Ÿå‘½å‘¨æœŸå‡½æ•°

ä¸»è¦å‚è€ƒå®˜æ–¹çš„[ç”Ÿå‘½å‘¨æœŸå›¾è°±](https://projects.wojtekmaj.pl/react-lifecycle-methods-diagram/)

å…·ä½“æœ‰å…³ç”Ÿå‘½å‘¨æœŸçš„å†…å®¹ æˆ‘ä¼šåœ¨ä¸‹å‡ ç« ä¸­æ›´æ–°

è¿™é‡Œ æˆ‘åªææœ€å¸¸ç”¨çš„å‡ ä¸ªç”Ÿå‘½å‘¨æœŸå‡½æ•°ä»¥åŠå®ƒä»¬çš„ç”¨é€”

- constructor

  - åˆå§‹åŒ–å†…éƒ¨çš„ state

  - ä¸ºäº‹ä»¶ç»‘å®š this

- render

  - React çš„çµé­‚ ç”¨äºæè¿° UI å’Œäº¤äº’

  - props / state / forceUpdate éƒ½ä¼šé‡æ–°è°ƒç”¨è¯¥ç”Ÿå‘½å‘¨æœŸ ä»è€Œä½¿é¡µé¢æ›´æ–°

- shouldComponentUpdate

  - å¯¹æ¯”æ›´æ–°å‰åæ•°æ® ä¼˜åŒ–æ€§èƒ½

- componentDidMount

  - ç½‘ç»œè¯·æ±‚

- componentWillUnmount

  - æ¸…é™¤å®šæ—¶å™¨ç­‰ ä¼˜åŒ–æ€§èƒ½

## çŠ¶æ€æå‡

çŠ¶æ€æå‡æ˜¯ä¸€ä¸ªæ¦‚å¿µæ€§çš„ä¸œè¥¿

çŠ¶æ€æŒ‡ ç»„ä»¶é—´å…±äº«çš„ä¸€äº›æ•°æ®

æå‡æŒ‡ å°†è¿™äº›çŠ¶æ€ä¿å­˜åœ¨ç¦»å®ƒä»¬æœ€è¿‘çš„çˆ¶ç»„ä»¶

æ¯”å¦‚æ›´æ”¹ä¸»é¢˜ æˆ‘ä»¬å°±éœ€è¦å°†ä¸»é¢˜è¿™ä¸ªçŠ¶æ€å­˜æ”¾åœ¨æ ¹ç»„ä»¶ä¸‹ ç„¶åé€šè¿‡ props ä¸€å±‚ä¸€å±‚å¾€ä¸‹ä¼ é€’

## ref

æˆ‘ä»¬å®ç°ä¸€ä¸ªç®€å•çš„ input è¯»å–ç”¨æˆ·è¾“å…¥å†…å®¹çš„åŠŸèƒ½

æˆ‘ä»¬å¾ˆå®¹æ˜“æƒ³åˆ°ç”¨ state æ¥ç»´æŠ¤ input å†…éƒ¨æ•°æ®

å½“ input çš„å†…å®¹å‘ç”Ÿå˜åŒ–æ—¶ æ›´æ–°è¿™ä¸ª state çš„æ•°æ®

ä»£ç å¦‚ä¸‹

```tsx
import { Component } from 'react';

interface IProps {}

interface IState {
  inputVal: string;
}

class App extends Component<IProps, IState> {
  constructor(props: IProps) {
    super(props);
    this.state = {
      inputVal: '',
    };
  }
  handleInputChange(e: any) {
    this.setState({
      inputVal: (e.target as HTMLInputElement).value,
    });
  }
  render() {
    return (
      <input
        value={this.state.inputVal}
        onChange={e => this.handleInputChange(e)}
      />
    );
  }
}

export default App;
```

ç°åœ¨æˆ‘ä»¬æƒ³ç›´æ¥é€šè¿‡ dom å»è·å– input çš„å€¼ è¯¥å¦‚ä½•å®ç°å‘¢

React ç»™æˆ‘ä»¬æä¾›äº† ref å±æ€§ é€šè¿‡è¿™ä¸ªå±æ€§ æˆ‘ä»¬å¯ä»¥è·å–åˆ°å…ƒç´ çš„å®ä¾‹

```tsx
import React, { Component } from 'react';

interface IProps {}

interface IState {}

class App extends Component<IProps, IState> {
  private inputRef: React.RefObject<HTMLInputElement>;

  constructor(props: IProps) {
    super(props);
    this.inputRef = React.createRef();
  }

  render() {
    return (
      <>
        {/* æ–¹å¼ä¸€ domåœ¨currentå±æ€§é‡Œ */}
        <input
          ref={this.inputRef}
          onChange={() => console.log(this.inputRef.current)}
        />

        {/* æ–¹å¼äºŒ domç›´æ¥åœ¨åˆ›å»ºçš„refé‡Œ */}
        <input
          ref={inputRef => (this.inputRef = inputRef as any)}
          onChange={() => console.log(this.inputRef)}
        />
      </>
    );
  }
}

export default App;
```

<Codesandbox id="class-ref-usage-slzdmq" />

ä¸¤è€…çš„åŒºåˆ«æ˜¯

- å‰è€… å…¶å®ä¾‹åœ¨ current å±æ€§ä¸‹

- è€Œé€šè¿‡å‡½æ•°åˆ›å»º å…¶å®ä¾‹å°±æ˜¯æˆ‘ä»¬æ‰€å‘½åçš„é‚£ä¸ªå±æ€§

**å†™åœ¨æœ€å åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ åƒä¸‡ä¸è¦è¿™æ ·å»æ“ä½œ dom**

**æ‰€æœ‰å¯ä»¥ä½¿ç”¨å£°æ˜å¼å®Œæˆçš„åŠŸèƒ½éƒ½ä¸è¦ä½¿ç”¨å‘½ä»¤å¼**

**é™¤éæˆ‘ä»¬éœ€è¦å®ç° èšç„¦ / åŠ¨ç”» ç­‰ å¿…é¡»è¦è·å–åˆ° dom çš„æ“ä½œ**

## å—æ§ç»„ä»¶ / éå—æ§ç»„ä»¶

å—æ§ç»„ä»¶å’Œéå—æ§ç»„ä»¶ä¸€èˆ¬éƒ½æ˜¯é’ˆå¯¹è¡¨å•å…ƒç´ æ¥è¯´çš„ å› ä¸ºå®ƒä»¬æœ‰è‡ªå·±çš„ value å±æ€§ å¯ä»¥ç®¡ç†è‡ªå·±çš„çŠ¶æ€

å—æ§çš„æ„æ€æ˜¯æŒ‡å…ƒç´ çš„çŠ¶æ€ç”±å¤–éƒ¨æ•°æ®æ¥ç»´æŠ¤ å¯ç†è§£ä¸ºæ•°æ®é©±åŠ¨è§†å›¾ å°±æ˜¯ä¸Šè¿°ä¾‹å­ä¸­çš„å‰è€…

éå—æ§çš„æ„æ€æ˜¯æŒ‡å…ƒç´ çš„çŠ¶æ€ç”±è‡ªå·±æ¥ç»´æŠ¤ å¯ç†è§£ä¸º jq æ“ä½œ dom æ¥æ‹¿æ•°æ® å°±æ˜¯ä¸Šè¿°ä¾‹å­ä¸­é€šè¿‡ ref æ¥æ“ä½œ

## context

å‡è®¾ æˆ‘ä»¬æœ‰ä¸€ä¸ª App ç»„ä»¶

ç„¶å App ç»„ä»¶ä¸‹æœ‰ä¸€ä¸ª HeaderWrapper ç»„ä»¶

HeaderWrapper ç»„ä»¶å†…éƒ¨ åˆæœ‰ä¸€ä¸ª Header ç»„ä»¶

é‚£ä¹ˆ å¦‚æœæˆ‘ä»¬æƒ³æŠŠ App ç»„ä»¶ä¸­çš„æ•°æ® åˆ° Header ç»„ä»¶

æ•°æ®æµå°±è¦ç»è¿‡ HeaderWrapper è¿™ä¸ªç»„ä»¶

æ•°æ®æµå¦‚ä¸‹

```text
App --> HeaderWrapper --> Header
```

ä½†æ˜¯ HeaderWrapper è¿™ä¸ªç»„ä»¶æ˜¯ä¸éœ€è¦ Header ç»„ä»¶éœ€è¦çš„é‚£ä¸ª props çš„

å°¤å…¶æ˜¯å½“ä½ ä½¿ç”¨äº†ç±»å‹çº¦æŸæ—¶ ä½ ä¼šéœ€è¦ä¸ºä¼ é€’æ•°æ®çš„ä¸­é—´ç»„ä»¶ ç¼–å†™å®ƒä»¬ä¸éœ€è¦çš„ props çº¦æŸ ğŸ˜³

å¦‚æœæˆ‘ä»¬å±‚å±‚ä¼ é€’ é‚£ä¹ˆä»£ç å¦‚ä¸‹

```tsx
import { Component } from 'react';

interface IProps {
  header?: string;
}

interface IState {
  header?: string;
}

class App extends Component<IProps, IState> {
  constructor(props: IProps) {
    super(props);
    this.state = {
      header: 'è¿™æ˜¯Headerç»„ä»¶éœ€è¦çš„å†…å®¹',
    };
  }
  render() {
    return <HeaderWrapper header={this.state.header} />;
  }
}

class HeaderWrapper extends Component<IProps, IState> {
  constructor(props: IProps) {
    super(props);
    this.state = {};
  }
  render() {
    return <Header {...this.props} />;
  }
}

class Header extends Component<IProps, IState> {
  constructor(props: IProps) {
    super(props);
    this.state = {};
  }
  render() {
    return <h1>{this.props.header}</h1>;
  }
}

export default App;
```

å¥½å§ è¿™åªæ˜¯ç»è¿‡äº†ä¸€å±‚ æˆ‘ä»¬å·²ç»æ„Ÿè§‰åˆ°äº†éº»çƒ¦ å¦‚æœæ˜¯ ğŸ¤”

è¿™æ—¶ React ç»™æˆ‘ä»¬æä¾›äº†ä¸€ä¸ªå±æ€§ **context** ç”¨æ¥è§£å†³è·¨ç»„ä»¶é€šä¿¡çš„é—®é¢˜

<img
  src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/4ea0321a715d492f8075fdde42619e90~tplv-k3u1fbpfcp-zoom-1.image"
  width="500"
/>

å¸¸ç”¨ API æœ‰

- React.createContext(defaultValue)

- contextType

- Provider

- Consumer

```tsx
import React, { Component } from 'react';

interface IProps {}

interface IState {}

// step1 åˆ›å»ºä¸€ä¸ªcontext å¯ä»¥åˆ›å»ºå¤šä¸ª
const HeaderContext = React.createContext({
  header: 'è¿™æ˜¯Headerç»„ä»¶éœ€è¦çš„å†…å®¹',
});

class App extends Component<IProps, IState> {
  constructor(props: IProps) {
    super(props);
    this.state = {};
  }
  render() {
    return (
      <HeaderContext.Provider value={{ header: 'è¿™æ˜¯Headerç»„ä»¶éœ€è¦çš„å†…å®¹' }}>
        <HeaderWrapper />
        <FunHeader />
      </HeaderContext.Provider>
    );
  }
}

// æ­¤æ—¶ æˆ‘ä»¬çš„HeaderWrapperç»„ä»¶å°±æ˜¯å¹²å‡€çš„ ä¸å†éœ€è¦ä¼ é€’å®ƒä¸éœ€è¦çš„props
// ä½†æ˜¯ å¦‚æœéœ€è¦ è¯¥ç»„ä»¶ä¹Ÿå¯ä»¥åœ¨contextä¸­æ‹¿åˆ°å€¼
class HeaderWrapper extends Component<IProps, IState> {
  constructor(props: IProps) {
    super(props);
    this.state = {};
  }
  render() {
    return <Header {...this.props} />;
  }
}

class Header extends Component<IProps, IState> {
  // step3 åœ¨éœ€è¦ä½¿ç”¨çš„åœ°æ–¹ å°†contentTypeèµ‹å€¼æˆæˆ‘ä»¬éœ€è¦çš„é‚£ä¸ªcontext
  static contextType = HeaderContext;
  constructor(props: IProps) {
    super(props);
    this.state = {};
  }
  render() {
    // step 4 ä½¿ç”¨ ğŸ¥°
    return <h1>{this.context.header}</h1>;
  }
}

// å¦‚æœæ˜¯å‡½æ•°å¼ç»„ä»¶ éœ€è¦ä½¿ç”¨ä¸‹è¿°å†™æ³•
function FunHeader() {
  return (
    <HeaderContext.Consumer>
      {value => <h1>{value.header}</h1>}
    </HeaderContext.Consumer>
  );
}

export default App;
```

ä½†æ˜¯ åœ¨å®é™…å¼€å‘ä¸­ æˆ‘ä»¬ä¸€èˆ¬ä¸ä¼šä½¿ç”¨ context

åœ¨ç”Ÿæˆç¯å¢ƒä¸‹ æˆ‘ä»¬ä¸€èˆ¬ä¼šä½¿ç”¨ redux / mobx

åœ¨ React 16.3 ä¹‹å‰ï¼ŒContext API ç”±äºå­˜åœ¨ç§ç§å±€é™æ€§ï¼Œ å¹¶æ²¡æœ‰è¢« React å®˜æ–¹æ¨å¹¿

ä¸»è¦æœ‰å¦‚ä¸‹é—®é¢˜

> å¦‚æœç»„ä»¶æä¾›çš„ä¸€ä¸ª Context å‘ç”Ÿäº†å˜åŒ–ï¼Œè€Œä¸­é—´çˆ¶ç»„ä»¶çš„ shouldComponentUpdate è¿”å› falseï¼Œ**é‚£ä¹ˆä½¿ç”¨åˆ°è¯¥å€¼çš„åä»£ç»„ä»¶ä¸ä¼šè¿›è¡Œæ›´æ–°**ã€‚ä½¿ç”¨äº† Context çš„ç»„ä»¶åˆ™å®Œå…¨å¤±æ§ï¼Œæ‰€ä»¥åŸºæœ¬ä¸Šæ²¡æœ‰åŠæ³•èƒ½å¤Ÿå¯é çš„æ›´æ–° Contextã€‚[è¿™ç¯‡åšå®¢æ–‡ç« ](https://medium.com/@mweststrate/how-to-safely-use-react-context-b7e343eff076)å¾ˆå¥½åœ°è§£é‡Šäº†ä¸ºä½•ä¼šå‡ºç°æ­¤ç±»é—®é¢˜ï¼Œä»¥åŠä½ è¯¥å¦‚ä½•è§„é¿å®ƒã€‚ Â â€”â€”React å®˜æ–¹

æœ‰å…³ context çš„å‘å±•å†ç¨‹ ä½ å¯ä»¥çœ‹ ğŸ‘‰<a href="https://react.docschina.org/docs/legacy-context.html#updating-context">è¿™é‡Œ</a>

## åˆæˆäº‹ä»¶

React ä¸­çš„ç»‘å®šäº‹ä»¶ onClick ç­‰ç­‰ æ˜¯ React ä¸­çš„åˆæˆäº‹ä»¶

å®ƒå’ŒåŸç”Ÿçš„ onclick äº‹ä»¶ ä¸åŒ ä¸»è¦æ˜¯ç”¨äºæŠ¹å¹³å„æµè§ˆå™¨ä¹‹é—´çš„å·®å¼‚

å› ä¸º React ä¸åªæ˜¯æœŸæœ›è¿è¡Œåœ¨ Web ç¯å¢ƒ ä¹ŸæœŸæœ›è¿è¡Œåœ¨å®¢æˆ·ç«¯ ios Android ç­‰

åœ¨ç»‘å®šäº‹ä»¶æ—¶ ä¼ å…¥çš„ç¬¬ä¸€ä¸ªå‚æ•°é»˜è®¤å°±æ˜¯ React ä¸­çš„ event å¯¹è±¡

åŒæ ·çš„ React ä¹Ÿå°è£…äº†è¿™ä¸ªå¯¹è±¡ ä¸ºäº†é€‚åˆæ‰€æœ‰å¼€å‘åœºæ™¯ä¸‹çš„ä½¿ç”¨

## dangerouslySetInnerHTML

å‡è®¾æœ‰ä»¥ä¸‹ä»£ç  æˆ‘ä»¬æƒ³è¦æ¸²æŸ“å‡º tag ä¸­çš„ dom å…ƒç´ 

ç›´æ¥æ¸²æŸ“çš„è¯ å®ƒä¼šè¢«å½“æˆå­—ç¬¦ä¸² æ¸²æŸ“åœ¨é¡µé¢ä¸Š

æˆ‘ä»¬éœ€è¦ä½¿ç”¨ dangerouslySetInnerHTML å‘Šè¯‰ React è¿™æ˜¯ä¸€ä¸ª dom å…ƒç´ 

ä½†æ˜¯ä¹Ÿå­˜åœ¨å‰¯ä½œç”¨ æ­£å¦‚å®ƒçš„åå­— dangerously ä¸€æ ·

ä¸åˆæ—¶å®œçš„ä½¿ç”¨ å¯èƒ½ä¼šä½ çš„é¡µé¢é­å— XSS æ”»å‡»

æ‰€ä»¥å¿˜æ‰è¿™ä¸ªå±æ€§å§ ğŸ˜›

```tsx
import { Component } from 'react';

interface IProps {}

interface IState {
  tag: string;
}

class App extends Component<IProps, IState> {
  constructor(props: IProps) {
    super(props);
    this.state = {
      tag: '<h2>HELLO REACT</h2>',
    };
  }
  render() {
    return (
      <>
        {/* é¡µé¢ä¸­æ˜¾ç¤º <h2>HELLO REACT</h2> */}
        {this.state.tag}

        {/* é¡µé¢æ­£ç¡®è§£æh2æ ‡ç­¾ */}
        <div dangerouslySetInnerHTML={{ __html: this.state.tag }}></div>
      </>
    );
  }
}

export default App;
```

## Fragments

æ‰€æœ‰çš„ JSX å¿…é¡»è¦æœ‰ä¸€ä¸ªæ ¹å…ƒç´ åŒ…è£¹

å¦‚æœä½ ä¸æƒ³åˆ›å»ºé¢å¤–çš„å…ƒç´  é‚£ä¹ˆä½ å°±å¯ä»¥ä½¿ç”¨ Fragments æ¥åŒ…è£¹å®ƒä»¬

è¯¥å…ƒç´ ä¸ä¼šåˆ›å»ºä»»ä½•é¢å¤–çš„ dom èŠ‚ç‚¹ æ‰€ä»¥ä½ å¯¹è¯¥ç»„ä»¶çš„ä»»ä½•æ“ä½œéƒ½ä¼šå¤±æ•ˆ

```jsx
import { Fragment } from 'react';

const App = () => {
  return (
    <Fragment>
      <div></div>
      <div></div>
    </Fragment>
  );
};

export default App;
```

ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨ç®€å†™

```jsx
const App = () => {
  return (
    <>
      <div></div>
      <div></div>
    </>
  );
};

export default App;
```

## StrictMode

ä½¿ç”¨è„šæ‰‹æ¶åˆ›å»ºé¡¹ç›®æ—¶ é»˜è®¤ä¼šåœ¨è·Ÿæ ‡ç­¾å¤–é¢åŒ…è£¹`StrictMode`

å’Œ`Fragment`ä¸€æ · `StrictMode`ä¸ä¼šåˆ›å»ºä»»ä½• UI å…ƒç´  æ­£å¦‚å­—é¢æ„æ€ä¸€æ · å®ƒä¸»è¦ç”¨äº

- è¯†åˆ«ä¸å®‰å…¨çš„ç”Ÿå‘½å‘¨æœŸ

- ä½¿ç”¨è¿‡æ—¶çš„ ref çš„ API

- æ£€æŸ¥æ„å¤–çš„å‰¯ä½œç”¨

  - å¼€å‘ç¯å¢ƒä¸‹ä¼šè°ƒç”¨ä¸¤æ¬¡ constructor

- è¯†åˆ«åºŸå¼ƒçš„ findDOMNode æ–¹æ³•

- æ£€æµ‹è¿‡æ—¶çš„ context API

## é”™è¯¯è¾¹ç•Œ

é”™è¯¯è¾¹ç•Œä¾èµ– `componentDidCatch` è¿™ä¸ªç”Ÿå‘½å‘¨æœŸå‡½æ•° æ‰€ä»¥ç›®å‰åªæœ‰ç±»ç»„ä»¶èƒ½å¤Ÿå®ç°é”™è¯¯è¾¹ç•Œ

é”™è¯¯è¾¹ç•Œèƒ½å¤Ÿå¸®åŠ©æˆ‘ä»¬åœ¨é¡µé¢å‡ºé”™çš„æƒ…å†µä¸‹ é™çº§ UI è€Œä¸è‡³äºé¡µé¢å´©æºƒ

<details>
<summary>ä¸‹é¢è´´ä¸€æ®µå®˜ç½‘çš„ demo æˆ³æˆ‘å±•å¼€ğŸ‘‡</summary>

```tsx
import React from 'react';

interface IProps {}

interface IErrorState {
  error: any;
  errorInfo: any;
}

interface ICountState {
  counter: number;
}

class ErrorBoundary extends React.Component<IProps, IErrorState> {
  constructor(props: IProps) {
    super(props);
    this.state = { error: null, errorInfo: null };
  }

  componentDidCatch(error: any, errorInfo: any) {
    // Catch errors in any components below and re-render with error message
    console.log('error:', error);
    console.log('errorInfo:', errorInfo);
    this.setState({
      error: error,
      errorInfo: errorInfo,
    });
    // You can also log error messages to an error reporting service here
  }

  render() {
    if (this.state.errorInfo) {
      // Error path
      return (
        <div>
          <h2>Something went wrong.</h2>
          <details style={{ whiteSpace: 'pre-wrap' }}>
            {this.state.error && this.state.error.toString()}
            <br />
            {this.state.errorInfo.componentStack}
          </details>
        </div>
      );
    }
    // Normally, just render children
    return this.props.children;
  }
}

class BuggyCounter extends React.Component<IProps, ICountState> {
  constructor(props: IProps) {
    super(props);
    this.state = { counter: 0 };
    this.handleClick = this.handleClick.bind(this);
  }

  handleClick() {
    this.setState(({ counter }) => ({
      counter: counter + 1,
    }));
  }

  render() {
    if (this.state.counter === 5) {
      // Simulate a JS error
      throw new Error('I crashed!');
    }
    return <h1 onClick={this.handleClick}>{this.state.counter}</h1>;
  }
}

function App() {
  return (
    <div>
      <p>
        <b>
          This is an example of error boundaries in React 16.
          <br />
          <br />
          Click on the numbers to increase the counters.
          <br />
          The counter is programmed to throw when it reaches 5. This simulates a
          JavaScript error in a component.
        </b>
      </p>
      <hr />
      <ErrorBoundary>
        <p>
          These two counters are inside the same error boundary. If one crashes,
          the error boundary will replace both of them.
        </p>
        <BuggyCounter />
        <BuggyCounter />
      </ErrorBoundary>
      <hr />
      <p>
        These two counters are each inside of their own error boundary. So if
        one crashes, the other is not affected.
      </p>
      <ErrorBoundary>
        <BuggyCounter />
      </ErrorBoundary>
      <ErrorBoundary>
        <BuggyCounter />
      </ErrorBoundary>
    </div>
  );
}

export default App;
```

</details>

## Render Props

> render prop æ˜¯ä¸€ä¸ªç”¨äºå‘ŠçŸ¥ç»„ä»¶éœ€è¦æ¸²æŸ“ä»€ä¹ˆå†…å®¹çš„å‡½æ•° prop

> https://react.docschina.org/docs/render-props.html

## é«˜é˜¶ç»„ä»¶

é«˜é˜¶ç»„ä»¶å°±æ˜¯ä¸€ä¸ªå‡½æ•° å®ƒæ¥æ”¶ä¸€ä¸ªç»„ä»¶ å¹¶è¿”å›ä¸€ä¸ªæ–°çš„ç»„ä»¶

ä¸»è¦åŠŸèƒ½æœ‰

- å¯æ“ä½œæ‰€æœ‰ä¼ å…¥çš„ props

- å¯æ“ä½œç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸ

- å¯æ“ä½œç»„ä»¶çš„ static æ–¹æ³•

- è·å– refs

- å¯æ“ä½œ state

- å¯ä»¥æ¸²æŸ“åŠ«æŒ

```tsx
import React, { Component } from 'react';

interface IProps {
  theme?: string;
}

interface IState {
  theme?: string;
}

class App extends Component<IProps, IState> {
  constructor(props: IProps) {
    super(props);
    this.state = {};
  }
  render() {
    return (
      <>
        <HeaderWrapper />
        <ArticleWrapper />
      </>
    );
  }
}

class Header extends Component<IProps, IState> {
  render() {
    return <p style={{ color: this.props.theme }}>NavBar</p>;
  }
}

class Article extends Component<IProps, IState> {
  constructor(props: IProps) {
    super(props);
    this.state = {};
  }
  render() {
    return <p>Article</p>;
  }
}

// å¢å¼ºprops  æ³›å‹Tè¡¨ç¤ºæ¥æ”¶ç»„ä»¶çš„props å› ä¸ºæˆ‘ä»¬éœ€è¦æ³¨å…¥æ–°çš„props æ‰€ä»¥Téœ€è¦ç»§æ‰¿æ‹¥æœ‰æ–°å±æ€§çš„æ¥å£
function ThemeHOC<T extends IProps>(Component: React.ComponentType<T>) {
  return class extends React.Component {
    render() {
      // ä¸ºç»„ä»¶æ³¨å…¥themeå±æ€§
      return <Component {...(this.props as T)} theme={'red'} />;
    }
  };
}

// åŠ«æŒç”Ÿå‘½å‘¨æœŸæ–¹æ³• props state renderæ–¹æ³•
function LifeHOC<T>(Component: React.ComponentType<T>) {
  return class extends React.Component {
    constructor(props: T) {
      super(props);

      // åŠ«æŒåˆ°åŸç»„ä»¶çš„å®ä¾‹ å¹¶å¯ä»¥ä¿®æ”¹å®ƒ
      console.log(this);

      // å¯æ“ä½œæ‰€æœ‰ä¼ å…¥çš„props
      // å¯æ“ä½œç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸ
      // å¯æ“ä½œç»„ä»¶çš„staticæ–¹æ³•
      // è·å–refs
      // å¯æ“ä½œstate
      // å¯ä»¥æ¸²æŸ“åŠ«æŒ
    }
    render() {
      return <Component {...(this.props as T)} />;
    }
  };
}

const HeaderWrapper = ThemeHOC(Header);
const ArticleWrapper = LifeHOC(Article);

export default App;
```

## ç±»å‹æ£€æŸ¥

å¦‚æœä½ çš„é¡¹ç›®è¿˜æœªä½¿ç”¨ typescript åˆæƒ³çº¦æŸç±»å‹çš„è¯

ä½ å¤§æ¦‚ä¼šä½¿ç”¨åˆ°è¿™ä¸ªåº“ `prop-types`

```jsx
import { Component } from 'react';
import PropTypes from 'prop-types';

export default class App extends Component {
  static propTypes = {
    nickname: PropTypes.string.isRequired,
    age: PropTypes.number,
  };

  static defaultProps = {
    nickname: 'nanshu',
    age: 18,
  };

  render() {
    return (
      <div>
        <h1>{this.props.nickname}</h1>
        <h1>{this.props.age}</h1>
      </div>
    );
  }
}
```

ä½†æ˜¯`prop-types`åªåš warning å±‚é¢çš„è­¦å‘Š âš ï¸ å®ƒä¸ä¼šæ‰“æ–­æˆ‘ä»¬çš„ç¨‹åº
